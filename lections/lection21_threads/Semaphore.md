# **üìå `Semaphore` –≤ Java**
### **–ß—Ç–æ —Ç–∞–∫–æ–µ `Semaphore`?**
üîπ `Semaphore` (–°–µ–º–∞—Ñ–æ—Ä) ‚Äì —ç—Ç–æ –º–µ—Ö–∞–Ω–∏–∑–º, –∫–æ—Ç–æ—Ä—ã–π **–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –∏–º–µ—é—â–∏—Ö –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É**.

üìå **–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω—ã—Ö –∑–∞–¥–∞—á–∞—Ö, –≥–¥–µ –µ—Å—Ç—å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã**, –Ω–∞–ø—Ä–∏–º–µ—Ä:
‚úî –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π –∫ —Å–µ—Ä–≤–µ—Ä—É.  
‚úî –ö–æ–Ω—Ç—Ä–æ–ª—å –∑–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –º–∞—à–∏–Ω –Ω–∞ –∑–∞–ø—Ä–∞–≤–∫–µ.  
‚úî –†–µ–≥—É–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö.

---

## **üîπ –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç–æ–¥—ã `Semaphore`**
| –ú–µ—Ç–æ–¥ | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------------|-------------------------------------------|
| `acquire()` | –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç 1 —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (–µ—Å–ª–∏ –Ω–µ—Ç ‚Äì –∂–¥–µ—Ç). |
| `acquire(int permits)` | –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π. |
| `tryAcquire()` | –ó–∞—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ, –Ω–æ –Ω–µ –∂–¥–µ—Ç (–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç `false`, –µ—Å–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö). |
| `release()` | –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç 1 —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ (—É–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç —Å–µ–º–∞—Ñ–æ—Ä). |
| `release(int permits)` | –û—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π. |
| `availablePermits()` | –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –¥–æ—Å—Ç—É–ø–Ω–æ. |

---

## **üîπ –ü—Ä–∏–º–µ—Ä 1: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å—É**
üìå **–£—Å–ª–æ–≤–∏–µ:**  
–£ –Ω–∞—Å –µ—Å—Ç—å **3 —Ä–∞–±–æ—á–∏—Ö –º–µ—Å—Ç–∞**, –Ω–æ **5 –ø–æ—Ç–æ–∫–æ–≤** –ø—ã—Ç–∞—é—Ç—Å—è –∏—Ö –∑–∞–Ω—è—Ç—å.

```java
import java.util.concurrent.*;

class Worker extends Thread {
    private final Semaphore semaphore;
    private final String name;

    public Worker(Semaphore semaphore, String name) {
        this.semaphore = semaphore;
        this.name = name;
    }

    @Override
    public void run() {
        try {
            semaphore.acquire(); // –ó–∞—Ö–≤–∞—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
            System.out.println(name + " –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É.");
            Thread.sleep(2000); // –°–∏–º—É–ª—è—Ü–∏—è —Ä–∞–±–æ—Ç—ã
            System.out.println(name + " –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É.");
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            semaphore.release(); // –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
        }
    }
}

public class SemaphoreExample {
    public static void main(String[] args) {
        Semaphore semaphore = new Semaphore(3); // –†–∞–∑—Ä–µ—à–∞–µ–º —Ç–æ–ª—å–∫–æ 3 –ø–æ—Ç–æ–∫–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ

        for (int i = 1; i <= 5; i++) {
            new Worker(semaphore, "–†–∞–±–æ—á–∏–π " + i).start();
        }
    }
}
```

### **üìå –í—ã–≤–æ–¥ (–ø—Ä–∏–º–µ—Ä)**
```
–†–∞–±–æ—á–∏–π 1 –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É.
–†–∞–±–æ—á–∏–π 2 –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É.
–†–∞–±–æ—á–∏–π 3 –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É.
(2 —Å–µ–∫—É–Ω–¥—ã)
–†–∞–±–æ—á–∏–π 1 –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É.
–†–∞–±–æ—á–∏–π 4 –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É.
–†–∞–±–æ—á–∏–π 2 –∑–∞–≤–µ—Ä—à–∏–ª —Ä–∞–±–æ—Ç—É.
–†–∞–±–æ—á–∏–π 5 –Ω–∞—á–∞–ª —Ä–∞–±–æ—Ç—É.
```
‚úÖ **–¢–æ–ª—å–∫–æ 3 –ø–æ—Ç–æ–∫–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ!** –û—Å—Ç–∞–ª—å–Ω—ã–µ **–∂–¥—É—Ç**, –ø–æ–∫–∞ –∫—Ç–æ-—Ç–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç –º–µ—Å—Ç–æ.

---

### **2Ô∏è‚É£ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ (–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∫–Ω–∏–≥)** üìö
**üîπ –£—Å–ª–æ–≤–∏–µ:**
- –í –±–∏–±–ª–∏–æ—Ç–µ–∫–µ –µ—Å—Ç—å **3 –∫–Ω–∏–≥–∏**.
- **–°—Ç—É–¥–µ–Ω—Ç—ã** –ø—ã—Ç–∞—é—Ç—Å—è –≤–∑—è—Ç—å –∫–Ω–∏–≥—É.
- –ï—Å–ª–∏ –∫–Ω–∏–≥ **–Ω–µ—Ç**, —Å—Ç—É–¥–µ–Ω—Ç—ã **–∂–¥—É—Ç**.
- –ö–æ–≥–¥–∞ –∫–Ω–∏–≥–∞ **–≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è**, —Å–ª–µ–¥—É—é—â–∏–π —Å—Ç—É–¥–µ–Ω—Ç –º–æ–∂–µ—Ç –≤–∑—è—Ç—å –µ—ë.

```java
import java.util.concurrent.*;

class Library {
    private final Semaphore books;

    public Library(int availableBooks) {
        this.books = new Semaphore(availableBooks);
    }

    public void borrowBook(String student) {
        try {
            System.out.println(student + " üìñ –∂–¥–µ—Ç –∫–Ω–∏–≥—É...");
            books.acquire(); // –ñ–¥–µ—Ç, –µ—Å–ª–∏ –∫–Ω–∏–≥ –Ω–µ—Ç
            System.out.println(student + " üìö –≤–∑—è–ª –∫–Ω–∏–≥—É –∏ —á–∏—Ç–∞–µ—Ç...");
            Thread.sleep(3000); // –ò–º–∏—Ç–∞—Ü–∏—è —á—Ç–µ–Ω–∏—è
            System.out.println(student + " üìñ –≤–µ—Ä–Ω—É–ª –∫–Ω–∏–≥—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É.");
        } catch (InterruptedException e) {
            e.printStackTrace();
        } finally {
            books.release(); // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º –∫–Ω–∏–≥—É
        }
    }
}

public class LibraryDemo {
    public static void main(String[] args) {
        Library library = new Library(3); // 3 –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–Ω–∏–≥–∏

        for (int i = 1; i <= 5; i++) {
            final String student = "–°—Ç—É–¥–µ–Ω—Ç " + i;
            new Thread(() -> library.borrowBook(student)).start();
        }
    }
}
```

### **üìå –í—ã–≤–æ–¥**
```
–°—Ç—É–¥–µ–Ω—Ç 1 üìñ –∂–¥–µ—Ç –∫–Ω–∏–≥—É...
–°—Ç—É–¥–µ–Ω—Ç 2 üìñ –∂–¥–µ—Ç –∫–Ω–∏–≥—É...
–°—Ç—É–¥–µ–Ω—Ç 3 üìñ –∂–¥–µ—Ç –∫–Ω–∏–≥—É...
–°—Ç—É–¥–µ–Ω—Ç 1 üìö –≤–∑—è–ª –∫–Ω–∏–≥—É –∏ —á–∏—Ç–∞–µ—Ç...
–°—Ç—É–¥–µ–Ω—Ç 2 üìö –≤–∑—è–ª –∫–Ω–∏–≥—É –∏ —á–∏—Ç–∞–µ—Ç...
–°—Ç—É–¥–µ–Ω—Ç 3 üìö –≤–∑—è–ª –∫–Ω–∏–≥—É –∏ —á–∏—Ç–∞–µ—Ç...
(3 —Å–µ–∫—É–Ω–¥—ã)
–°—Ç—É–¥–µ–Ω—Ç 1 üìñ –≤–µ—Ä–Ω—É–ª –∫–Ω–∏–≥—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É.
–°—Ç—É–¥–µ–Ω—Ç 4 üìö –≤–∑—è–ª –∫–Ω–∏–≥—É –∏ —á–∏—Ç–∞–µ—Ç...
–°—Ç—É–¥–µ–Ω—Ç 2 üìñ –≤–µ—Ä–Ω—É–ª –∫–Ω–∏–≥—É –≤ –±–∏–±–ª–∏–æ—Ç–µ–∫—É.
–°—Ç—É–¥–µ–Ω—Ç 5 üìö –≤–∑—è–ª –∫–Ω–∏–≥—É –∏ —á–∏—Ç–∞–µ—Ç...
```
‚úÖ **–ú–∞–∫—Å–∏–º—É–º 3 —Å—Ç—É–¥–µ–Ω—Ç–∞ —á–∏—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ!** –û—Å—Ç–∞–ª—å–Ω—ã–µ **–∂–¥—É—Ç, –ø–æ–∫–∞ –∫—Ç–æ-—Ç–æ –≤–µ—Ä–Ω–µ—Ç –∫–Ω–∏–≥—É**.

üìå **–¢–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Ç—É–∞—Ü–∏–∏, –≥–¥–µ —Ä–µ—Å—É—Ä—Å—ã (–∫–Ω–∏–≥–∏) –æ–≥—Ä–∞–Ω–∏—á–µ–Ω—ã. üöÄ**

## **üîπ –ü—Ä–∏–º–µ—Ä 3: `tryAcquire()` (–Ω–µ –∂–¥–µ—Ç)**
üìå **–£—Å–ª–æ–≤–∏–µ:**  
–ï—Å–ª–∏ —Ä–µ—Å—É—Ä—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äì –ø–æ—Ç–æ–∫ **–Ω–µ –∂–¥–µ—Ç**, –∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥—Ä—É–≥–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ.

```java
import java.util.concurrent.*;

public class TryAcquireExample {
    public static void main(String[] args) {
        Semaphore semaphore = new Semaphore(2);

        Runnable task = () -> {
            if (semaphore.tryAcquire()) {
                try {
                    System.out.println(Thread.currentThread().getName() + " –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø.");
                    Thread.sleep(3000);
                } catch (InterruptedException e) {
                    e.printStackTrace();
                } finally {
                    System.out.println(Thread.currentThread().getName() + " –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å.");
                    semaphore.release();
                }
            } else {
                System.out.println(Thread.currentThread().getName() + " –Ω–µ –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É.");
            }
        };

        for (int i = 1; i <= 4; i++) {
            new Thread(task, "–ü–æ—Ç–æ–∫ " + i).start();
        }
    }
}
```

### **üìå –í—ã–≤–æ–¥**
```
–ü–æ—Ç–æ–∫ 1 –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø.
–ü–æ—Ç–æ–∫ 2 –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø.
–ü–æ—Ç–æ–∫ 3 –Ω–µ –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É.
–ü–æ—Ç–æ–∫ 4 –Ω–µ –ø–æ–ª—É—á–∏–ª –¥–æ—Å—Ç—É–ø –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç –¥—Ä—É–≥—É—é –∑–∞–¥–∞—á—É.
(3 —Å–µ–∫—É–Ω–¥—ã)
–ü–æ—Ç–æ–∫ 1 –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å.
–ü–æ—Ç–æ–∫ 2 –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å.
```
‚úÖ **–ï—Å–ª–∏ `tryAcquire()` –Ω–µ –º–æ–∂–µ—Ç –∑–∞—Ö–≤–∞—Ç–∏—Ç—å —Å–µ–º–∞—Ñ–æ—Ä ‚Äì –ø–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω—è–µ—Ç —á—Ç–æ-—Ç–æ –¥—Ä—É–≥–æ–µ.**

---

## **üîπ –ü—Ä–∏–º–µ—Ä 4: `release(int permits)`**
üìå **–£—Å–ª–æ–≤–∏–µ:**  
–†–∞–∑—Ä–µ—à–∞–µ–º —Å—Ä–∞–∑—É **2 –ø–æ—Ç–æ–∫–∞** –≤–º–µ—Å—Ç–æ –æ–¥–Ω–æ–≥–æ.

```java
import java.util.concurrent.*;

public class ReleaseExample {
    public static void main(String[] args) {
        Semaphore semaphore = new Semaphore(0);

        Runnable task = () -> {
            try {
                semaphore.acquire();
                System.out.println(Thread.currentThread().getName() + " –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É.");
            } catch (InterruptedException e) {
                e.printStackTrace();
            }
        };

        new Thread(task, "–ü–æ—Ç–æ–∫ 1").start();
        new Thread(task, "–ü–æ—Ç–æ–∫ 2").start();

        try {
            Thread.sleep(2000);
            System.out.println("–†–∞–∑—Ä–µ—à–∞–µ–º –¥–≤—É–º –ø–æ—Ç–æ–∫–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å.");
            semaphore.release(2); // –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Å—Ä–∞–∑—É 2 –ø–æ—Ç–æ–∫–∞
        } catch (InterruptedException e) {
            e.printStackTrace();
        }
    }
}
```

### **üìå –í—ã–≤–æ–¥**
```
–†–∞–∑—Ä–µ—à–∞–µ–º –¥–≤—É–º –ø–æ—Ç–æ–∫–∞–º —Ä–∞–±–æ—Ç–∞—Ç—å.
–ü–æ—Ç–æ–∫ 1 –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É.
–ü–æ—Ç–æ–∫ 2 –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–∞–±–æ—Ç—É.
```
‚úÖ **–û–±–∞ –ø–æ—Ç–æ–∫–∞ –Ω–∞—á–∏–Ω–∞—é—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ, —Ç–∞–∫ –∫–∞–∫ `release(2)` —Å—Ä–∞–∑—É –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç –¥–≤–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è.**

---

## **üìå –í—ã–≤–æ–¥**
‚úî `Semaphore` **–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤, –∏–º–µ—é—â–∏—Ö –¥–æ—Å—Ç—É–ø –∫ —Ä–µ—Å—É—Ä—Å—É**.  
‚úî –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ **–±–∞–∑–∞—Ö –¥–∞–Ω–Ω—ã—Ö, —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Å–∏—Å—Ç–µ–º–∞—Ö, –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç–∏**.  
‚úî `acquire()` ‚Äì **–∂–¥–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ**, `tryAcquire()` ‚Äì **–Ω–µ –∂–¥–µ—Ç**.  
‚úî `release()` ‚Äì –æ—Å–≤–æ–±–æ–∂–¥–∞–µ—Ç —Ä–µ—Å—É—Ä—Å, –º–æ–∂–Ω–æ –æ—Å–≤–æ–±–æ–¥–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ (`release(2)`).
