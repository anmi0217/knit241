## üì¶ **6. –°–∫–æ—É–ø—ã (Scopes) –±–∏–Ω–æ–≤ –≤ Spring**

---

### üìò –ß—Ç–æ —Ç–∞–∫–æ–µ —Å–∫–æ—É–ø?

> **–°–∫–æ—É–ø** ‚Äî —ç—Ç–æ –æ–±–ª–∞—Å—Ç—å –∂–∏–∑–Ω–∏ –±–∏–Ω–∞: —Å–∫–æ–ª—å–∫–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω–æ –∏ –∫–∞–∫ –¥–æ–ª–≥–æ –æ–Ω–∏ –±—É–¥—É—Ç –∂–∏—Ç—å.

Spring –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–æ–∑–¥–∞—ë—Ç **–æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä** –∫–∞–∂–¥–æ–≥–æ –±–∏–Ω–∞ –Ω–∞ –≤–µ—Å—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Äî —ç—Ç–æ **singleton-—Å–∏–Ω–≥–ª—Ç–æ–Ω**. –ù–æ —Ç—ã –º–æ–∂–µ—à—å –∏–∑–º–µ–Ω–∏—Ç—å —ç—Ç–æ –ø–æ–≤–µ–¥–µ–Ω–∏–µ.

---

### üî† –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∫–æ—É–ø—ã –≤ Spring:

| –°–∫–æ—É–ø       | –û–ø–∏—Å–∞–Ω–∏–µ                                                |
|-------------|---------------------------------------------------------|
| `singleton` | –û–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä –Ω–∞ –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)         |
| `prototype` | –ù–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∫–∞–∂–¥—ã–π —Ä–∞–∑ –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `getBean()`       |
| `request`   | –û–¥–∏–Ω –±–∏–Ω –Ω–∞ HTTP-–∑–∞–ø—Ä–æ—Å (—Ç–æ–ª—å–∫–æ –≤ web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö)      |
| `session`   | –û–¥–∏–Ω –±–∏–Ω –Ω–∞ HTTP-—Å–µ—Å—Å–∏—é (web)                           |
| `application` | –û–¥–∏–Ω –±–∏–Ω –Ω–∞ –≤–µ—Å—å ServletContext                      |
| `websocket` | –û–¥–∏–Ω –±–∏–Ω –Ω–∞ WebSocket-—Å–µ—Å—Å–∏—é                            |

---

### üß™ –ü—Ä–∏–º–µ—Ä: singleton (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)

```java
@Component
public class SingletonBean {
    public SingletonBean() {
        System.out.println("–°–æ–∑–¥–∞–Ω singleton-–±–∏–Ω");
    }
}
```

```java
SingletonBean a = ctx.getBean(SingletonBean.class);
SingletonBean b = ctx.getBean(SingletonBean.class);
System.out.println(a == b); // true
```

---

### üß™ –ü—Ä–∏–º–µ—Ä: prototype

```java
@Component
@Scope("prototype")
public class PrototypeBean {
    public PrototypeBean() {
        System.out.println("–°–æ–∑–¥–∞–Ω prototype-–±–∏–Ω");
    }
}
```

```java
PrototypeBean a = ctx.getBean(PrototypeBean.class);
PrototypeBean b = ctx.getBean(PrototypeBean.class);
System.out.println(a == b); // false
```

---

### ‚ö†Ô∏è –í–∞–∂–Ω–æ: `@PostConstruct` —É prototype-–±–∏–Ω–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏, –Ω–æ Spring **–Ω–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Ö —É–Ω–∏—á—Ç–æ–∂–µ–Ω–∏–µ–º**! –¢–æ –µ—Å—Ç—å `@PreDestroy` –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è!

---

### üß™ –ü—Ä–∏–º–µ—Ä –¥–ª—è –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

```java
@Component
@Scope(value = WebApplicationContext.SCOPE_REQUEST, proxyMode = ScopedProxyMode.TARGET_CLASS)
public class RequestScopedBean {}
```

- Spring —Å–æ–∑–¥–∞—Å—Ç –Ω–æ–≤—ã–π –±–∏–Ω **–Ω–∞ –∫–∞–∂–¥—ã–π HTTP-–∑–∞–ø—Ä–æ—Å**
- –ù—É–∂–µ–Ω `proxyMode`, –∏–Ω–∞—á–µ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è –≤–Ω–µ–¥—Ä–∏—Ç—å –±–∏–Ω –≤ singleton (–æ–± —ç—Ç–æ–º –ø–æ–≥–æ–≤–æ—Ä–∏–º –Ω–∞ –≤–µ–±-–ª–µ–∫—Ü–∏–∏)

---

### üóÉÔ∏è –°—Ä–∞–≤–Ω–µ–Ω–∏–µ:

| –°–∫–æ—É–ø       | –ö–æ–ª-–≤–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–æ–≤ | –£–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è Spring | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ                         |
|-------------|---------------------|---------------------|----------------------------------------|
| singleton   | 1                   | –î–∞                  | –ü–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞                           |
| prototype   | ‚àû (–Ω–∞ –∫–∞–∂–¥—ã–π –≤—ã–∑–æ–≤) | –¢–æ–ª—å–∫–æ —Å–æ–∑–¥–∞–Ω–∏–µ     | –õ–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ, –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã         |
| request     | 1 –Ω–∞ –∑–∞–ø—Ä–æ—Å         | –î–∞                  | –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã, —Ñ–æ—Ä–º—ã, dto –≤ web          |
| session     | 1 –Ω–∞ —Å–µ—Å—Å–∏—é         | –î–∞                  | –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –∫–æ—Ä–∑–∏–Ω–∞                   |

---

## ‚úÖ –í—ã–≤–æ–¥:

- `singleton` ‚Äî –¥–µ—Ñ–æ–ª—Ç, –ø–æ–¥—Ö–æ–¥–∏—Ç –ø–æ—á—Ç–∏ –≤—Å–µ–≥–¥–∞
- `prototype` ‚Äî –µ—Å–ª–∏ –Ω—É–∂–µ–Ω –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –∫–∞–∂–¥—ã–π —Ä–∞–∑
- –í web-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `request`, `session` –∏ –¥—Ä.
- –ü—Ä–∏ –Ω–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö —Å–∫–æ—É–ø–∞—Ö –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–ø—Ä–æ–∫—Å–∏**, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

---
