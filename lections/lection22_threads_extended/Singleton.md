
## **4. –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–∏–Ω–≥–ª–µ—Ç–æ–Ω**

### **–û–ø–∞—Å–Ω–æ—Å—Ç–∏ –ª–µ–Ω–∏–≤–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (`lazy initialization`)**

–°–∏–Ω–≥–ª–µ—Ç–æ–Ω ‚Äî —ç—Ç–æ –ø–∞—Ç—Ç–µ—Ä–Ω, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–∏–π, —á—Ç–æ —É –∫–ª–∞—Å—Å–∞ –µ—Å—Ç—å **—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä**.

–í –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π —Å—Ä–µ–¥–µ –ø—Ä–æ–±–ª–µ–º–∞ —Å–∏–Ω–≥–ª–µ—Ç–æ–Ω–∞ –∑–∞–∫–ª—é—á–∞–µ—Ç—Å—è –≤ **–ª–µ–Ω–∏–≤–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏**:

- –ï—Å–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–æ–∑–¥–∞—é—Ç —ç–∫–∑–µ–º–ø–ª—è—Ä, –≤–æ–∑–º–æ–∂–Ω—ã **–≥–æ–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è** (race condition).
- –û–¥–∏–Ω –ø–æ—Ç–æ–∫ –º–æ–∂–µ—Ç –ø–æ–ª—É—á–∏—Ç—å **—á–∞—Å—Ç–∏—á–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç**.

–ü—Ä–∏–º–µ—Ä **–Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å–∏–Ω–≥–ª–µ—Ç–æ–Ω–∞** –±–µ–∑ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:

```java
class Singleton {
    private static Singleton instance;

    private Singleton() {}

    public static Singleton getInstance() {
        if (instance == null) { // –ù–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Ç–æ–∫–æ–≤ –º–æ–≥—É—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–π—Ç–∏ —Å—é–¥–∞!
            instance = new Singleton();
        }
        return instance;
    }
}
```

‚ùå **–ü—Ä–æ–±–ª–µ–º–∞:** –µ—Å–ª–∏ –¥–≤–∞ –ø–æ—Ç–æ–∫–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤—ã–∑–æ–≤—É—Ç `getInstance()`, –æ–Ω–∏ –æ–±–∞ –º–æ–≥—É—Ç —Å–æ–∑–¥–∞—Ç—å **—Ä–∞–∑–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã**.

üëâ **–†–µ—à–µ–Ω–∏–µ:** –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã.

---

## **–ü–æ–¥—Ö–æ–¥—ã –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–∏–Ω–≥–ª—Ç–æ–Ω–∞**

### **1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `synchronized` (–ø—Ä–æ—Å—Ç, –Ω–æ –Ω–µ—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω)**

–°–∞–º—ã–π –ø—Ä–æ—Å—Ç–æ–π —Å–ø–æ—Å–æ–± ‚Äî —Å–¥–µ–ª–∞—Ç—å `synchronized` –º–µ—Ç–æ–¥ `getInstance()`.

‚úÖ **–ì–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å, –Ω–æ —Å–Ω–∏–∂–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**.

```java
class Singleton {
    private static Singleton instance;

    private Singleton() {}

    public static synchronized Singleton getInstance() {
        if (instance == null) {
            instance = new Singleton();
        }
        return instance;
    }
}
```

üî¥ **–ú–∏–Ω—É—Å—ã**:

- –ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ `getInstance()` –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫.
- –î–∞–∂–µ –µ—Å–ª–∏ –æ–±—ä–µ–∫—Ç —É–∂–µ —Å–æ–∑–¥–∞–Ω, **–ø–æ—Ç–æ–∫–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –∂–¥–∞—Ç—å**, —á—Ç–æ –∑–∞–º–µ–¥–ª—è–µ—Ç —Ä–∞–±–æ—Ç—É.

---

### **2. Double-Checked Locking —Å `volatile` (—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç)**

–ß—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–∏—à–Ω–µ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º **–¥–≤–æ–π–Ω—É—é –ø—Ä–æ–≤–µ—Ä–∫—É (Double-Checked Locking)**.

‚úÖ **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ ‚Äî –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ.**

```java
class Singleton {
    private static volatile Singleton instance; // volatile –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ

    private Singleton() {}

    public static Singleton getInstance() {
        if (instance == null) { // –ü–µ—Ä–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)
            synchronized (Singleton.class) {
                if (instance == null) { // –í—Ç–æ—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π)
                    instance = new Singleton();
                }
            }
        }
        return instance;
    }
}
```

üîπ **–ü–æ—á–µ–º—É –Ω—É–∂–µ–Ω `volatile`?**  
–ë–µ–∑ `volatile` –≤–æ–∑–º–æ–∂–Ω–∞ —Å–∏—Ç—É–∞—Ü–∏—è, –∫–æ–≥–¥–∞ –ø–æ—Ç–æ–∫ —É–≤–∏–¥–∏—Ç **—á–∞—Å—Ç–∏—á–Ω–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç**.

üîπ **–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç Double-Checked Locking?**

1. –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç —É–∂–µ —Å–æ–∑–¥–∞–Ω (`instance != null`), **—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è**.
2. –ï—Å–ª–∏ –æ–±—ä–µ–∫—Ç –µ—â–µ –Ω–µ —Å–æ–∑–¥–∞–Ω:
    - –û–¥–∏–Ω –ø–æ—Ç–æ–∫ –∑–∞—Ö–æ–¥–∏—Ç –≤ `synchronized` –±–ª–æ–∫ –∏ —Å–æ–∑–¥–∞–µ—Ç `instance`.
    - –î—Ä—É–≥–∏–µ –ø–æ—Ç–æ–∫–∏ –≤–∏–¥—è—Ç —É–∂–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç.

‚úÖ **–ë—ã—Å—Ç—Ä–æ** –∏ **—ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ**.

---

### **3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `static final` (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–ª–∞—Å—Å–∞)**

–≠—Ç–æ—Ç –≤–∞—Ä–∏–∞–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç **–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–ª–∞—Å—Å–∞**, –∞ –Ω–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –≤—ã–∑–æ–≤–µ `getInstance()`.

```java
class Singleton {
    private static final Singleton INSTANCE = new Singleton(); // –°–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∫–ª–∞—Å—Å–∞

    private Singleton() {}

    public static Singleton getInstance() {
        return INSTANCE;
    }
}
```

üîπ **–ü–æ—á–µ–º—É —ç—Ç–æ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ?**  
JVM **–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑**, –¥–∞–∂–µ –≤ –º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π —Å—Ä–µ–¥–µ.

‚úÖ **–ë—ã—Å—Ç—Ä–æ, –ø—Ä–æ—Å—Ç–æ, –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ**.  
‚ùå **–ú–∏–Ω—É—Å**: –æ–±—ä–µ–∫—Ç —Å–æ–∑–¥–∞–µ—Ç—Å—è –¥–∞–∂–µ **–µ—Å–ª–∏ –æ–Ω –Ω–µ –Ω—É–∂–µ–Ω**.

---

### **4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `enum` (–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –æ—Ç JVM)**

–õ—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Å–æ–∑–¥–∞–Ω–∏—è **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–∏–Ω–≥–ª—Ç–æ–Ω–∞** ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `enum`.

```java
enum Singleton {
    INSTANCE; // JVM –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Å–æ–∑–¥–∞—Å—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —ç–∫–∑–µ–º–ø–ª—è—Ä

    public void doSomething() {
        System.out.println("Singleton —Ä–∞–±–æ—Ç–∞–µ—Ç!");
    }
}
```

üìå **–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ `enum`-—Å–∏–Ω–≥–ª–µ—Ç–æ–Ω–∞**:

- `enum` **–≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** –Ω–∞ —É—Ä–æ–≤–Ω–µ JVM.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞—â–∏—â–µ–Ω –æ—Ç **—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏**.
- –ü—Ä–æ—Å—Ç –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏:
    
    ```java
    Singleton.INSTANCE.doSomething();
    ```
    

‚úÖ **–°–∞–º—ã–π –Ω–∞–¥–µ–∂–Ω—ã–π –∏ –∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–∏–Ω–≥–ª–µ—Ç–æ–Ω–∞.**  
‚ùå **–ú–∏–Ω—É—Å**: –Ω–µ–ª—å–∑—è —Å–¥–µ–ª–∞—Ç—å –ª–µ–Ω–∏–≤—É—é –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é.

---

### **–í—ã–≤–æ–¥**

|–í–∞—Ä–∏–∞–Ω—Ç|–ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å|–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å|–õ–µ–Ω–∏–≤—ã–π?|–ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏/—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏|
|---|---|---|---|---|
|`synchronized` –º–µ—Ç–æ–¥|‚úÖ –î–∞|‚ùå –ú–µ–¥–ª–µ–Ω–Ω–æ|‚úÖ –î–∞|‚ùå –ù–µ—Ç|
|Double-Checked Locking (`volatile`)|‚úÖ –î–∞|‚úÖ –ë—ã—Å—Ç—Ä–æ|‚úÖ –î–∞|‚ùå –ù–µ—Ç|
|`static final` (–∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ)|‚úÖ –î–∞|‚úÖ –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ|‚ùå –ù–µ—Ç|‚ùå –ù–µ—Ç|
|`enum`|‚úÖ –î–∞|‚úÖ –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ|‚ùå –ù–µ—Ç|‚úÖ –î–∞|

---

### **–ö–∞–∫–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –≤—ã–±—Ä–∞—Ç—å?**

- **–ï—Å–ª–∏ –≤–∞–∂–Ω–∞ –ø—Ä–æ—Å—Ç–æ—Ç–∞ –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** `enum` ‚úÖ
- **–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ª–µ–Ω–∏–≤–æ—Å—Ç—å –∏ —Ö–æ—Ä–æ—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** Double-Checked Locking (`volatile`) ‚úÖ
- **–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —Å–∫–æ—Ä–æ—Å—Ç—å:** `static final` ‚úÖ

üìå **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: **–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `enum`, –µ—Å–ª–∏ –ª–µ–Ω–∏–≤–æ—Å—Ç—å –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞**.  
üìå **–ï—Å–ª–∏ –Ω—É–∂–Ω–∞ –ª–µ–Ω–∏–≤–æ—Å—Ç—å, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Double-Checked Locking.** üöÄ