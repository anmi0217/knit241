/*
2.6 –ó–∞–¥–∞—á–∞ ¬´–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π –ø–µ—Ä–µ–µ–∑–¥¬ª üöÜüöó
üìå –û–ø–∏—Å–∞–Ω–∏–µ:
–ï—Å—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ –∏ –ø–æ–µ–∑–¥.

–ï—Å–ª–∏ –ø–æ–µ–∑–¥ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç—Å—è, –º–∞—à–∏–Ω—ã –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∏ –∂–¥—É—Ç.
–ü–æ—Å–ª–µ —Ç–æ–≥–æ, –∫–∞–∫ –ø–æ–µ–∑–¥ –ø—Ä–æ–µ–¥–µ—Ç, –º–∞—à–∏–Ω—ã –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –¥–≤–∏–∂–µ–Ω–∏–µ.
üîπ –ß—Ç–æ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å?
‚úî –ü–æ—Ç–æ–∫ "–ü–æ–µ–∑–¥" –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∞–≤—Ç–æ–º–æ–±–∏–ª–∏ (wait()).
‚úî –ü–æ—Ç–æ–∫ "–ü–æ–µ–∑–¥" —Å–æ–æ–±—â–∞–µ—Ç –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ (notifyAll()).
‚úî –ú–∞—à–∏–Ω—ã –∂–¥—É—Ç, –µ—Å–ª–∏ –ø–æ–µ–∑–¥ –µ–¥–µ—Ç, –∏ –ø—Ä–æ–¥–æ–ª–∂–∞—é—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ—Å–ª–µ notifyAll().
 */


package org.knit.solutions.org2.lab6;
import org.knit.solutions.annotations.Discription;

import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

@Discription(value = 6, name = "–ñ–µ–ª–µ–∑–Ω–æ–¥–æ—Ä–æ–∂–Ω—ã–π –ø–µ—Ä–µ–µ–∑–¥")
public class Task6 {
    public static void main(String[] args) {
        RailwayCrossing crossing = new RailwayCrossing(); // –°–æ–∑–¥–∞–µ–º –ø–µ—Ä–µ–µ–∑–¥

        // –°–æ–∑–¥–∞–µ–º –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤ –¥–ª—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
        ExecutorService carExecutor = Executors.newFixedThreadPool(5);

        // –°–æ–∑–¥–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ—Ç–æ–∫–∏ –¥–ª—è –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π
        for (int i = 1; i <= 5; i++) {
            carExecutor.execute(new Car(crossing, "–ê–≤—Ç–æ–º–æ–±–∏–ª—å " + i));
        }

        // –°–æ–∑–¥–∞–µ–º –∏ –∑–∞–ø—É—Å–∫–∞–µ–º –ø–æ—Ç–æ–∫ –¥–ª—è –ø–æ–µ–∑–¥–∞
        Thread trainThread = new Thread(new Train(crossing));
        trainThread.start();

        // –û–∂–∏–¥–∞–µ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã –ø–æ—Ç–æ–∫–æ–≤ (–≤ —Ä–µ–∞–ª—å–Ω–æ–π –∑–∞–¥–∞—á–µ —ç—Ç–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ)
        try {
            trainThread.join();
        } catch (InterruptedException e) {
            System.out.println("–û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ –ø—Ä–µ—Ä–≤–∞–Ω.");
        }

        carExecutor.shutdown(); // –ó–∞–≤–µ—Ä—à–∞–µ–º –ø—É–ª –ø–æ—Ç–æ–∫–æ–≤
    }
}
